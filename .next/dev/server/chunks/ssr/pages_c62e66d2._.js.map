{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/CharacterCreation.tsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { useMutation } from '@tanstack/react-query';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { User, UserCircle2, Sparkles, ChevronRight } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { apiRequest, queryClient } from '@/lib/queryClient';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport type { GenderType } from '@shared/schema';\r\n\r\ninterface CharacterCreationProps {\r\n  onComplete: () => void;\r\n}\r\n\r\nexport default function CharacterCreation({ onComplete }: CharacterCreationProps) {\r\n  const [step, setStep] = useState<'gender' | 'name'>('gender');\r\n  const [selectedGender, setSelectedGender] = useState<GenderType | null>(null);\r\n  const [name, setName] = useState('');\r\n  const { toast } = useToast();\r\n\r\n  const createCharacterMutation = useMutation({\r\n    mutationFn: async ({ name, gender }: { name: string; gender: GenderType }) => {\r\n      const response = await apiRequest('POST', '/api/character', { name, gender });\r\n      return response.json();\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['/api/character'] });\r\n      toast({\r\n        title: 'Персонаж создан!',\r\n        description: `Добро пожаловать, ${name}!`,\r\n      });\r\n      onComplete();\r\n    },\r\n    onError: () => {\r\n      toast({\r\n        title: 'Ошибка',\r\n        description: 'Не удалось создать персонажа',\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n\r\n  const handleGenderSelect = (gender: GenderType) => {\r\n    setSelectedGender(gender);\r\n    setStep('name');\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    if (!selectedGender || !name.trim()) return;\r\n    createCharacterMutation.mutate({ name: name.trim(), gender: selectedGender });\r\n  };\r\n\r\n  const handleBack = () => {\r\n    setStep('gender');\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-background to-muted flex flex-col items-center justify-center p-4\">\r\n      <motion.div\r\n        initial={{ opacity: 0, y: 20 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        className=\"text-center mb-8\"\r\n      >\r\n        <div className=\"flex items-center justify-center gap-2 mb-2\">\r\n          <Sparkles className=\"w-6 h-6 text-primary\" />\r\n          <h1 className=\"text-2xl font-bold\">Создание персонажа</h1>\r\n          <Sparkles className=\"w-6 h-6 text-primary\" />\r\n        </div>\r\n        <p className=\"text-muted-foreground\">\r\n          {step === 'gender' ? 'Выберите своего персонажа' : 'Как вас зовут?'}\r\n        </p>\r\n      </motion.div>\r\n\r\n      <AnimatePresence mode=\"wait\">\r\n        {step === 'gender' && (\r\n          <motion.div\r\n            key=\"gender\"\r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            exit={{ opacity: 0, x: 20 }}\r\n            className=\"flex flex-col sm:flex-row gap-4 w-full max-w-md\"\r\n          >\r\n            <Card \r\n              className={`flex-1 cursor-pointer transition-all hover-elevate ${\r\n                selectedGender === 'male' ? 'ring-2 ring-primary' : ''\r\n              }`}\r\n              onClick={() => handleGenderSelect('male')}\r\n              data-testid=\"button-gender-male\"\r\n            >\r\n              <CardContent className=\"flex flex-col items-center justify-center p-8 gap-4\">\r\n                <div className=\"w-24 h-24 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center\">\r\n                  <User className=\"w-12 h-12 text-blue-500\" />\r\n                </div>\r\n                <span className=\"text-lg font-medium\">Он</span>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card \r\n              className={`flex-1 cursor-pointer transition-all hover-elevate ${\r\n                selectedGender === 'female' ? 'ring-2 ring-primary' : ''\r\n              }`}\r\n              onClick={() => handleGenderSelect('female')}\r\n              data-testid=\"button-gender-female\"\r\n            >\r\n              <CardContent className=\"flex flex-col items-center justify-center p-8 gap-4\">\r\n                <div className=\"w-24 h-24 rounded-full bg-pink-100 dark:bg-pink-900/30 flex items-center justify-center\">\r\n                  <UserCircle2 className=\"w-12 h-12 text-pink-500\" />\r\n                </div>\r\n                <span className=\"text-lg font-medium\">Она</span>\r\n              </CardContent>\r\n            </Card>\r\n          </motion.div>\r\n        )}\r\n\r\n        {step === 'name' && (\r\n          <motion.div\r\n            key=\"name\"\r\n            initial={{ opacity: 0, x: 20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            exit={{ opacity: 0, x: -20 }}\r\n            className=\"w-full max-w-md\"\r\n          >\r\n            <Card>\r\n              <CardContent className=\"p-6 space-y-6\">\r\n                <div className=\"flex items-center justify-center\">\r\n                  <div className={`w-20 h-20 rounded-full flex items-center justify-center ${\r\n                    selectedGender === 'male' \r\n                      ? 'bg-blue-100 dark:bg-blue-900/30' \r\n                      : 'bg-pink-100 dark:bg-pink-900/30'\r\n                  }`}>\r\n                    {selectedGender === 'male' ? (\r\n                      <User className=\"w-10 h-10 text-blue-500\" />\r\n                    ) : (\r\n                      <UserCircle2 className=\"w-10 h-10 text-pink-500\" />\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label htmlFor=\"character-name\" className=\"text-sm font-medium\">\r\n                    Имя персонажа\r\n                  </label>\r\n                  <Input\r\n                    id=\"character-name\"\r\n                    value={name}\r\n                    onChange={(e) => setName(e.target.value)}\r\n                    placeholder=\"Введите имя...\"\r\n                    maxLength={20}\r\n                    className=\"text-center text-lg\"\r\n                    data-testid=\"input-character-name\"\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter' && name.trim()) {\r\n                        handleSubmit();\r\n                      }\r\n                    }}\r\n                  />\r\n                  <p className=\"text-xs text-muted-foreground text-center\">\r\n                    {name.length}/20 символов\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"flex gap-2\">\r\n                  <Button \r\n                    variant=\"outline\" \r\n                    onClick={handleBack}\r\n                    className=\"flex-1\"\r\n                    data-testid=\"button-back\"\r\n                  >\r\n                    Назад\r\n                  </Button>\r\n                  <Button\r\n                    onClick={handleSubmit}\r\n                    disabled={!name.trim() || createCharacterMutation.isPending}\r\n                    className=\"flex-1\"\r\n                    data-testid=\"button-create-character\"\r\n                  >\r\n                    {createCharacterMutation.isPending ? (\r\n                      'Создание...'\r\n                    ) : (\r\n                      <>\r\n                        Создать\r\n                        <ChevronRight className=\"w-4 h-4 ml-1\" />\r\n                      </>\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/index.tsx"],"sourcesContent":["import { useState, useCallback, useEffect } from 'react';\nimport type { GameState, LeaderboardEntry } from '@shared/schema';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { MainMenu } from '@/components/MainMenu';\nimport { GameScreen } from '@/components/GameScreen';\nimport { Leaderboard } from '@/components/Leaderboard';\nimport { LevelSelect } from '@/components/LevelSelect';\nimport { BoostShop } from '@/components/BoostShop';\nimport { AccessoryShop } from '@/components/AccessoryShop';\nimport { CharacterCustomize } from '@/components/CharacterCustomize';\nimport { CommunityInviteDialog } from '@/components/CommunityInviteDialog';\nimport { BeadsBox } from '@/components/BeadsBox';\nimport CharacterCreation from './CharacterCreation';\nimport { useUser } from '@/contexts/UserContext';\nimport { queryClient, apiRequest } from '@/lib/queryClient';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { type LevelConfig, LEVELS } from '@/lib/levelConfig';\nimport { useToast } from '@/hooks/use-toast';\n\ntype Screen = 'menu' | 'levelSelect' | 'game' | 'leaderboard' | 'shop' | 'accessoryShop' | 'customize';\ntype LeaderboardFilter = 'all' | 'week' | 'today' | 'friends';\n\nexport default function Home() {\n  const [currentScreen, setCurrentScreen] = useState<Screen>('menu');\n  const [selectedLevel, setSelectedLevel] = useState<LevelConfig>(LEVELS[0]);\n  const [showCommunityInvite, setShowCommunityInvite] = useState(false);\n  const [showBeadsBox, setShowBeadsBox] = useState(false);\n  const [leaderboardFilter, setLeaderboardFilter] = useState<LeaderboardFilter>('all');\n  const [useCryptoTicket, setUseCryptoTicket] = useState(false);\n  const { user, isLoading: isUserLoading, refreshUser } = useUser();\n  const { toast } = useToast();\n  \n  // Fetch crypto tickets\n  const { data: cryptoTicketsData } = useQuery<{ count: number }>({\n    queryKey: ['/api/user/crypto-tickets/count'],\n    enabled: !!user,\n  });\n\n  const { data: characterExists, isLoading: isCharacterLoading, refetch: refetchCharacter } = useQuery<{ exists: boolean }>({\n    queryKey: ['/api/character/exists'],\n    enabled: !!user,\n  });\n\n  const { data: leaderboard = [], isLoading: isLeaderboardLoading, isFetching: isLeaderboardFetching } = useQuery<LeaderboardEntry[]>({\n    queryKey: ['/api/leaderboard', leaderboardFilter],\n    queryFn: async () => {\n      if (leaderboardFilter === 'friends') {\n        const response = await fetch('/api/leaderboard/friends', { credentials: 'include' });\n        if (!response.ok) throw new Error('Failed to fetch friends leaderboard');\n        return response.json();\n      }\n      const response = await fetch(`/api/leaderboard?period=${leaderboardFilter}`, { credentials: 'include' });\n      if (!response.ok) throw new Error('Failed to fetch leaderboard');\n      return response.json();\n    },\n    enabled: currentScreen === 'leaderboard',\n  });\n\n  const submitScoreMutation = useMutation({\n    mutationFn: async ({ gameState, levelId }: { gameState: GameState; levelId: number }) => {\n      if (!user) return;\n      \n      const response = await apiRequest('POST', '/api/scores', {\n        score: gameState.score,\n        cryptoBtc: gameState.cryptoCollected.btc,\n        cryptoEth: gameState.cryptoCollected.eth,\n        cryptoUsdt: gameState.cryptoCollected.usdt,\n        maxCombo: gameState.maxCombo,\n        accuracy: gameState.shotsTotal > 0 \n          ? Math.round((gameState.shotsHit / gameState.shotsTotal) * 100) \n          : 0,\n        duration: 45 - gameState.timeLeft,\n        won: gameState.won,\n        levelId,\n      });\n      \n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/leaderboard'] });\n      refreshUser();\n      \n      // Show community invite after first game for Telegram users\n      if (data?.gamesPlayed === 1) {\n        setTimeout(() => setShowCommunityInvite(true), 2000);\n      }\n    },\n  });\n\n  const handleGameEnd = useCallback((gameState: GameState) => {\n    submitScoreMutation.mutate({ gameState, levelId: selectedLevel.id });\n  }, [submitScoreMutation, selectedLevel.id]);\n\n  const handlePlay = useCallback(() => {\n    setCurrentScreen('levelSelect');\n  }, []);\n\n  const handleSelectLevel = useCallback(async (level: LevelConfig, withCryptoTicket?: boolean) => {\n    if (withCryptoTicket) {\n      // Consume crypto ticket before starting game\n      try {\n        const response = await apiRequest('POST', '/api/user/crypto-tickets/use', { levelId: level.id });\n        if (!response.ok) {\n          const data = await response.json();\n          console.error('Failed to use crypto ticket:', data.error);\n          toast({\n            title: \"Крипто-билет недоступен\",\n            description: \"Игра начнётся без крипто-режима\",\n            variant: \"destructive\",\n          });\n          // Don't use ticket if consumption failed\n          setSelectedLevel(level);\n          setUseCryptoTicket(false);\n          setCurrentScreen('game');\n          return;\n        }\n        // Ticket consumed successfully\n        queryClient.invalidateQueries({ queryKey: ['/api/user/crypto-tickets/count'] });\n        setSelectedLevel(level);\n        setUseCryptoTicket(true);\n        setCurrentScreen('game');\n      } catch (error) {\n        console.error('Error using crypto ticket:', error);\n        toast({\n          title: \"Ошибка активации билета\",\n          description: \"Игра начнётся без крипто-режима\",\n          variant: \"destructive\",\n        });\n        // Proceed without ticket on error\n        setSelectedLevel(level);\n        setUseCryptoTicket(false);\n        setCurrentScreen('game');\n      }\n    } else {\n      setSelectedLevel(level);\n      setUseCryptoTicket(false);\n      setCurrentScreen('game');\n    }\n  }, [toast]);\n\n  const handleViewLeaderboard = useCallback(() => {\n    setCurrentScreen('leaderboard');\n  }, []);\n\n  const handleMainMenu = useCallback(() => {\n    setCurrentScreen('menu');\n  }, []);\n\n  const handleShop = useCallback(() => {\n    setCurrentScreen('shop');\n  }, []);\n\n  const handleAccessoryShop = useCallback(() => {\n    setCurrentScreen('accessoryShop');\n  }, []);\n\n  const handleCustomize = useCallback(() => {\n    setCurrentScreen('customize');\n  }, []);\n\n  const handleBeadsBox = useCallback(() => {\n    setShowBeadsBox(true);\n  }, []);\n\n  const handleCharacterCreated = useCallback(() => {\n    refetchCharacter();\n  }, [refetchCharacter]);\n\n  if (isUserLoading || isCharacterLoading) {\n    return <LoadingScreen />;\n  }\n\n  if (user && characterExists && !characterExists.exists) {\n    return <CharacterCreation onComplete={handleCharacterCreated} />;\n  }\n\n  const renderScreen = () => {\n    switch (currentScreen) {\n      case 'levelSelect':\n        return (\n          <LevelSelect\n            completedLevels={user?.completedLevels ?? []}\n            onSelectLevel={handleSelectLevel}\n            onBack={handleMainMenu}\n            cryptoTickets={cryptoTicketsData?.count ?? 0}\n          />\n        );\n      \n      case 'game':\n        return (\n          <GameScreen\n            level={selectedLevel}\n            isLevelCompleted={(user?.completedLevels ?? []).includes(selectedLevel.id)}\n            onGameEnd={handleGameEnd}\n            onViewLeaderboard={handleViewLeaderboard}\n            onMainMenu={handleMainMenu}\n            useCryptoTicket={useCryptoTicket}\n          />\n        );\n      \n      case 'leaderboard':\n        return (\n          <Leaderboard\n            entries={leaderboard}\n            currentUserId={user?.id}\n            isLoading={isLeaderboardLoading}\n            isFetching={isLeaderboardFetching}\n            onBack={handleMainMenu}\n            filter={leaderboardFilter}\n            onFilterChange={setLeaderboardFilter}\n          />\n        );\n      \n      case 'shop':\n        return (\n          <BoostShop onBack={handleMainMenu} />\n        );\n      \n      case 'accessoryShop':\n        return (\n          <AccessoryShop onBack={handleMainMenu} />\n        );\n      \n      case 'customize':\n        return (\n          <CharacterCustomize onBack={handleMainMenu} />\n        );\n      \n      default:\n        return (\n          <MainMenu\n            user={user}\n            onPlay={handlePlay}\n            onLeaderboard={handleViewLeaderboard}\n            onShop={handleShop}\n            onAccessoryShop={handleAccessoryShop}\n            onCustomize={handleCustomize}\n            onBeadsBox={handleBeadsBox}\n            isLoading={submitScoreMutation.isPending}\n          />\n        );\n    }\n  };\n\n  return (\n    <>\n      {renderScreen()}\n      <CommunityInviteDialog \n        open={showCommunityInvite} \n        onOpenChange={setShowCommunityInvite} \n      />\n      {showBeadsBox && (\n        <BeadsBox onClose={() => setShowBeadsBox(false)} />\n      )}\n    </>\n  );\n}\n\nfunction LoadingScreen() {\n  return (\n    <div className=\"min-h-screen flex flex-col items-center justify-center p-4 bg-background\">\n      <div className=\"w-16 h-16 mb-6 rounded-full bg-primary/20 animate-pulse flex items-center justify-center\">\n        <div className=\"w-10 h-10 rounded-full bg-primary/40 animate-pulse\" />\n      </div>\n      <Skeleton className=\"h-8 w-48 mb-2\" />\n      <Skeleton className=\"h-4 w-32\" />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 800, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/LeagueLeaderboard.tsx"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\r\nimport { useParams, useLocation } from \"wouter\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { ArrowLeft, Trophy, Users, Crown, Medal, Award, Loader2, Sparkles, User, AlertTriangle, Calendar } from \"lucide-react\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { useUser } from \"@/contexts/UserContext\";\r\nimport { motion } from \"framer-motion\";\r\n\r\ninterface LeagueData {\r\n  id: string;\r\n  slug: string;\r\n  nameRu: string;\r\n  nameEn: string;\r\n  icon: string;\r\n  minBeads: number;\r\n  maxRank: number | null;\r\n  themeColor: string;\r\n  sortOrder: number;\r\n  isActive: boolean;\r\n}\r\n\r\ninterface LeaderboardEntry {\r\n  rank: number;\r\n  odoserId: string;\r\n  name: string;\r\n  ratingScore: number;\r\n  beadsBalance: number;\r\n  photoUrl: string | null;\r\n  characterType: string | null;\r\n  characterImageUrl: string | null;\r\n}\r\n\r\ninterface LeagueLeaderboardData {\r\n  league: LeagueData;\r\n  leaderboard: LeaderboardEntry[];\r\n  playerCount: number;\r\n}\r\n\r\ninterface MyPositionData {\r\n  inLeague: boolean;\r\n  rank?: number;\r\n  playerCount: number;\r\n}\r\n\r\ninterface SeasonData {\r\n  id: number;\r\n  seasonNumber: number;\r\n  month: number;\r\n  year: number;\r\n  isActive: boolean;\r\n}\r\n\r\nexport default function LeagueLeaderboard() {\r\n  const params = useParams<{ slug: string }>();\r\n  const [, setLocation] = useLocation();\r\n  const { user } = useUser();\r\n  const slug = params.slug;\r\n\r\n  const { data, isLoading, isFetching } = useQuery<LeagueLeaderboardData>({\r\n    queryKey: [\"/api/leagues\", slug, \"leaderboard\"],\r\n    queryFn: async () => {\r\n      const res = await fetch(`/api/leagues/${slug}/leaderboard?limit=100`);\r\n      if (!res.ok) throw new Error(\"Failed to load leaderboard\");\r\n      return res.json();\r\n    },\r\n    enabled: !!slug,\r\n  });\r\n\r\n  const { data: myPosition } = useQuery<MyPositionData>({\r\n    queryKey: [\"/api/leagues\", slug, \"my-position\"],\r\n    queryFn: async () => {\r\n      const res = await fetch(`/api/leagues/${slug}/my-position`);\r\n      if (!res.ok) throw new Error(\"Failed to load position\");\r\n      return res.json();\r\n    },\r\n    enabled: !!slug && !!user?.telegramId,\r\n  });\r\n\r\n  const { data: activeSeason } = useQuery<SeasonData | null>({\r\n    queryKey: [\"/api/season/active\"],\r\n  });\r\n\r\n  const getMonthName = (month: number) => {\r\n    const months = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', \r\n                    'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'];\r\n    return months[month - 1] || '';\r\n  };\r\n\r\n  // Check if player is at risk of relegation (within 10% of maxRank or near playerCount limit)\r\n  const getRelegationInfo = () => {\r\n    if (!myPosition?.inLeague || !myPosition.rank) return null;\r\n    \r\n    const league = data?.league;\r\n    if (!league?.maxRank) return null;\r\n    \r\n    // Player is at risk if they are within 10% of maxRank cutoff\r\n    const threshold = Math.floor(league.maxRank * 0.9);\r\n    const isAtRisk = myPosition.rank >= threshold;\r\n    \r\n    if (!isAtRisk) return null;\r\n    \r\n    return {\r\n      rank: myPosition.rank,\r\n      maxRank: league.maxRank,\r\n    };\r\n  };\r\n\r\n  const relegationInfo = getRelegationInfo();\r\n\r\n  const getRankIcon = (rank: number) => {\r\n    switch (rank) {\r\n      case 1:\r\n        return <Crown className=\"w-5 h-5 text-yellow-500\" />;\r\n      case 2:\r\n        return <Medal className=\"w-5 h-5 text-gray-400\" />;\r\n      case 3:\r\n        return <Award className=\"w-5 h-5 text-amber-600\" />;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!data?.league) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background p-4\">\r\n        <Card>\r\n          <CardContent className=\"p-6 text-center\">\r\n            <p className=\"text-muted-foreground\">Лига не найдена</p>\r\n            <Button \r\n              variant=\"outline\" \r\n              onClick={() => setLocation(\"/\")}\r\n              className=\"mt-4\"\r\n            >\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n              На главную\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const { league, leaderboard, playerCount } = data;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <div \r\n        className=\"p-4 text-white\"\r\n        style={{ backgroundColor: league.themeColor }}\r\n      >\r\n        <div className=\"flex items-center gap-3 mb-4\">\r\n          <Button \r\n            variant=\"ghost\" \r\n            size=\"icon\"\r\n            onClick={() => setLocation(\"/\")}\r\n            className=\"text-white hover:bg-white/20\"\r\n            data-testid=\"button-back\"\r\n          >\r\n            <ArrowLeft className=\"w-5 h-5\" />\r\n          </Button>\r\n          <div className=\"flex-1\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-3xl\">{league.icon}</span>\r\n              <h1 className=\"text-2xl font-bold\">{league.nameRu}</h1>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-2 gap-3\">\r\n          <Card className=\"bg-white/20 border-0 text-white\">\r\n            <CardContent className=\"p-3 flex items-center gap-2\">\r\n              <Users className=\"w-5 h-5\" />\r\n              <div>\r\n                <div className=\"text-lg font-bold\" data-testid=\"text-player-count\">{playerCount}</div>\r\n                <div className=\"text-xs opacity-80\">Игроков</div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n          {myPosition?.inLeague && myPosition.rank && (\r\n            <Card className=\"bg-white/20 border-0 text-white\">\r\n              <CardContent className=\"p-3 flex items-center gap-2\">\r\n                <Trophy className=\"w-5 h-5\" />\r\n                <div>\r\n                  <div className=\"text-lg font-bold\" data-testid=\"text-my-rank\">\r\n                    {myPosition.rank} из {myPosition.playerCount}\r\n                  </div>\r\n                  <div className=\"text-xs opacity-80\">Ваша позиция</div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n          {!myPosition?.inLeague && user?.telegramId && (\r\n            <Card className=\"bg-white/20 border-0 text-white\">\r\n              <CardContent className=\"p-3\">\r\n                <div className=\"text-sm opacity-80\">Вы не в этой лиге</div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n          {!user?.telegramId && (\r\n            <Card className=\"bg-white/20 border-0 text-white\">\r\n              <CardContent className=\"p-3\">\r\n                <div className=\"text-sm opacity-80\">Войдите через Telegram</div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"mt-3 text-sm opacity-80\">\r\n          Требования: {league.minBeads.toLocaleString()} Beads\r\n          {league.maxRank && ` и топ-${league.maxRank}`}\r\n        </div>\r\n\r\n        {/* Season info */}\r\n        {activeSeason && (\r\n          <div className=\"mt-3 flex items-center gap-2 text-sm opacity-90\">\r\n            <Calendar className=\"w-4 h-4\" />\r\n            <span data-testid=\"text-current-season\">\r\n              Сезон {activeSeason.seasonNumber} — {getMonthName(activeSeason.month)} {activeSeason.year}\r\n            </span>\r\n          </div>\r\n        )}\r\n\r\n        {/* Relegation warning */}\r\n        {relegationInfo && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            className=\"mt-3 p-2 bg-orange-500/30 rounded-lg flex items-center gap-2\"\r\n            data-testid=\"warning-relegation\"\r\n          >\r\n            <AlertTriangle className=\"w-4 h-4 text-orange-200\" />\r\n            <span className=\"text-sm\">\r\n              Внимание! Вы на {relegationInfo.rank} месте из {relegationInfo.maxRank}. Рискуете вылететь из лиги!\r\n            </span>\r\n          </motion.div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"p-4\">\r\n        <Card>\r\n          <CardHeader className=\"pb-2\">\r\n            <CardTitle className=\"text-lg flex items-center gap-2\">\r\n              <Trophy className=\"w-5 h-5\" />\r\n              Рейтинг лиги\r\n              {isFetching && <Loader2 className=\"w-4 h-4 animate-spin ml-2\" />}\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {leaderboard.length === 0 ? (\r\n              <div className=\"text-center py-8 text-muted-foreground\">\r\n                <p>В этой лиге пока нет игроков</p>\r\n              </div>\r\n            ) : (\r\n              <ScrollArea className=\"h-[50vh]\">\r\n                <div className=\"space-y-2\">\r\n                  {leaderboard.map((entry, index) => {\r\n                    const isCurrentUser = entry.odoserId === user?.id;\r\n                    const isTopThree = entry.rank <= 3;\r\n                    \r\n                    return (\r\n                      <motion.div\r\n                        key={entry.odoserId}\r\n                        initial={{ opacity: 0, x: -20 }}\r\n                        animate={{ opacity: 1, x: 0 }}\r\n                        transition={{ delay: index * 0.03, duration: 0.2 }}\r\n                        className={`flex items-center gap-3 p-3 rounded-xl border transition-all ${\r\n                          isCurrentUser \r\n                            ? \"bg-primary/10 border-primary shadow-md\" \r\n                            : isTopThree \r\n                              ? \"bg-gradient-to-r from-background to-muted/30 border-muted\" \r\n                              : \"hover:bg-muted/50\"\r\n                        }`}\r\n                        data-testid={`leaderboard-entry-${entry.rank}`}\r\n                      >\r\n                        <div className=\"w-10 flex justify-center\">\r\n                          {getRankIcon(entry.rank) ? (\r\n                            <div className=\"relative\">\r\n                              {getRankIcon(entry.rank)}\r\n                              {isTopThree && (\r\n                                <Sparkles className=\"w-3 h-3 absolute -top-1 -right-1 text-yellow-400\" />\r\n                              )}\r\n                            </div>\r\n                          ) : (\r\n                            <span className={`font-bold text-lg ${\r\n                              entry.rank <= 10 ? \"text-foreground\" : \"text-muted-foreground\"\r\n                            }`}>\r\n                              {entry.rank}\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                        \r\n                        <div className=\"relative\">\r\n                          <Avatar \r\n                            className={`${isTopThree ? 'w-12 h-12 ring-2 ring-offset-2 ring-offset-background' : 'w-10 h-10'}`}\r\n                            style={isTopThree ? { '--tw-ring-color': league.themeColor } as React.CSSProperties : undefined}\r\n                          >\r\n                            {entry.characterImageUrl ? (\r\n                              <AvatarImage \r\n                                src={entry.characterImageUrl} \r\n                                alt=\"\"\r\n                                className=\"object-cover object-top\"\r\n                                data-testid={`img-character-${entry.rank}`}\r\n                              />\r\n                            ) : null}\r\n                            <AvatarFallback className=\"bg-gradient-to-br from-muted to-muted/50\">\r\n                              <User className={`${isTopThree ? 'w-6 h-6' : 'w-5 h-5'} text-muted-foreground`} />\r\n                            </AvatarFallback>\r\n                          </Avatar>\r\n                        </div>\r\n                        \r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-1.5\">\r\n                            <span \r\n                              className={`font-semibold truncate ${isTopThree ? 'text-base' : 'text-sm'}`}\r\n                              data-testid={`text-name-${entry.rank}`}\r\n                            >\r\n                              {entry.name}\r\n                            </span>\r\n                            {isCurrentUser && (\r\n                              <Badge \r\n                                variant=\"default\" \r\n                                className=\"text-[10px] px-1.5 py-0\"\r\n                                style={{ backgroundColor: league.themeColor }}\r\n                              >\r\n                                Вы\r\n                              </Badge>\r\n                            )}\r\n                          </div>\r\n                          <div className=\"text-xs text-muted-foreground flex items-center gap-1\">\r\n                            <span>#{entry.rank} в рейтинге</span>\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        <div className=\"text-right\">\r\n                          <div \r\n                            className={`font-bold ${isTopThree ? 'text-lg' : 'text-base'}`}\r\n                            style={{ color: league.themeColor }}\r\n                            data-testid={`text-rating-${entry.rank}`}\r\n                          >\r\n                            {entry.ratingScore.toLocaleString()}\r\n                          </div>\r\n                          <div className=\"text-[10px] text-muted-foreground uppercase tracking-wide\">\r\n                            Рейтинг\r\n                          </div>\r\n                        </div>\r\n                      </motion.div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </ScrollArea>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1603, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/Withdraw.tsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { useQuery, useMutation } from '@tanstack/react-query';\r\nimport { useUser } from '@/contexts/UserContext';\r\nimport { queryClient, apiRequest } from '@/lib/queryClient';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Label } from '@/components/ui/label';\r\nimport { ArrowLeft, Bitcoin, Loader2, AlertCircle, CheckCircle2, Clock, XCircle, Info } from 'lucide-react';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { SiEthereum, SiTether } from 'react-icons/si';\r\nimport { Link } from 'wouter';\r\nimport type { WithdrawalConfig, WithdrawalRequest } from '@shared/schema';\r\n\r\ntype CryptoType = 'btc' | 'eth' | 'usdt';\r\ntype UsdtNetwork = 'bep20' | 'trc20' | 'erc20' | 'ton';\r\n\r\nconst NETWORK_LABELS: Record<UsdtNetwork, { name: string; fullName: string }> = {\r\n  bep20: { name: 'BEP-20', fullName: 'Binance Smart Chain' },\r\n  trc20: { name: 'TRC-20', fullName: 'TRON Network' },\r\n  erc20: { name: 'ERC-20', fullName: 'Ethereum Network' },\r\n  ton: { name: 'TON', fullName: 'TON Network' },\r\n};\r\n\r\nconst STATUS_LABELS: Record<string, { label: string; color: string; icon: any }> = {\r\n  pending: { label: 'Ожидает', color: 'bg-yellow-500/20 text-yellow-400', icon: Clock },\r\n  approved: { label: 'Одобрено', color: 'bg-blue-500/20 text-blue-400', icon: CheckCircle2 },\r\n  completed: { label: 'Выполнено', color: 'bg-green-500/20 text-green-400', icon: CheckCircle2 },\r\n  rejected: { label: 'Отклонено', color: 'bg-red-500/20 text-red-400', icon: XCircle },\r\n};\r\n\r\nexport default function Withdraw() {\r\n  const { user, refreshUser } = useUser();\r\n  const { toast } = useToast();\r\n  \r\n  const [selectedCrypto, setSelectedCrypto] = useState<CryptoType | null>(null);\r\n  const [selectedNetwork, setSelectedNetwork] = useState<UsdtNetwork | null>(null);\r\n  const [amount, setAmount] = useState('');\r\n  const [walletAddress, setWalletAddress] = useState('');\r\n  const [networkConfirmed, setNetworkConfirmed] = useState(false);\r\n\r\n  const { data: config } = useQuery<WithdrawalConfig>({\r\n    queryKey: ['/api/withdrawal/config'],\r\n  });\r\n\r\n  const { data: myWithdrawals = [] } = useQuery<WithdrawalRequest[]>({\r\n    queryKey: ['/api/withdrawal/my'],\r\n  });\r\n\r\n  const withdrawMutation = useMutation({\r\n    mutationFn: async () => {\r\n      const response = await apiRequest('POST', '/api/withdrawal/request', {\r\n        cryptoType: selectedCrypto,\r\n        network: selectedCrypto === 'usdt' ? selectedNetwork : selectedCrypto,\r\n        amount,\r\n        walletAddress,\r\n      });\r\n      return response.json();\r\n    },\r\n    onSuccess: () => {\r\n      toast({ title: 'Заявка создана', description: 'Ваша заявка на вывод отправлена на рассмотрение' });\r\n      queryClient.invalidateQueries({ queryKey: ['/api/withdrawal/my'] });\r\n      refreshUser();\r\n      resetForm();\r\n    },\r\n    onError: (error: any) => {\r\n      toast({ \r\n        title: 'Ошибка', \r\n        description: error.message || 'Не удалось создать заявку',\r\n        variant: 'destructive',\r\n      });\r\n    },\r\n  });\r\n\r\n  const resetForm = () => {\r\n    setSelectedCrypto(null);\r\n    setSelectedNetwork(null);\r\n    setAmount('');\r\n    setWalletAddress('');\r\n    setNetworkConfirmed(false);\r\n  };\r\n\r\n  const getBalance = () => {\r\n    if (!user) return 0;\r\n    if (selectedCrypto === 'btc') return user.btcBalance;\r\n    if (selectedCrypto === 'eth') return user.ethBalance;\r\n    if (selectedCrypto === 'usdt') return user.usdtBalance;\r\n    return 0;\r\n  };\r\n\r\n  const getMinAmount = () => {\r\n    if (!config || !selectedCrypto) return 0;\r\n    if (selectedCrypto === 'btc') return config.btc.minAmount;\r\n    if (selectedCrypto === 'eth') return config.eth.minAmount;\r\n    if (selectedCrypto === 'usdt' && selectedNetwork) {\r\n      return config.usdt[selectedNetwork]?.minAmount || 0;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  const getNetworkFee = () => {\r\n    if (!config || !selectedCrypto) return 0;\r\n    if (selectedCrypto === 'btc') return config.btc.networkFee;\r\n    if (selectedCrypto === 'eth') return config.eth.networkFee;\r\n    if (selectedCrypto === 'usdt' && selectedNetwork) {\r\n      return config.usdt[selectedNetwork]?.networkFee || 0;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  const isNetworkEnabled = (network: UsdtNetwork) => {\r\n    return config?.usdt[network]?.enabled ?? false;\r\n  };\r\n\r\n  const canSubmit = () => {\r\n    if (!selectedCrypto || !amount || !walletAddress) return false;\r\n    if (selectedCrypto === 'usdt' && !selectedNetwork) return false;\r\n    if (!networkConfirmed) return false;\r\n    const numAmount = parseFloat(amount);\r\n    if (isNaN(numAmount) || numAmount <= 0) return false;\r\n    if (numAmount < getMinAmount()) return false;\r\n    if (numAmount > getBalance()) return false;\r\n    return true;\r\n  };\r\n\r\n  const formatCrypto = (value: number, crypto: CryptoType) => {\r\n    if (crypto === 'btc') return value.toFixed(8);\r\n    if (crypto === 'eth') return value.toFixed(8);\r\n    return value.toFixed(2);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-gray-900 to-black text-white p-4\">\r\n      <div className=\"max-w-lg mx-auto\">\r\n        <div className=\"flex items-center gap-2 mb-6\">\r\n          <Link href=\"/\">\r\n            <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back\">\r\n              <ArrowLeft className=\"w-5 h-5\" />\r\n            </Button>\r\n          </Link>\r\n          <h1 className=\"text-2xl font-bold\">Вывод криптовалюты</h1>\r\n        </div>\r\n\r\n        {!selectedCrypto ? (\r\n          <div className=\"space-y-4\">\r\n            <Alert className=\"bg-blue-500/10 border-blue-500/30\" data-testid=\"alert-withdrawal-info\">\r\n              <Info className=\"w-4 h-4 text-blue-400\" />\r\n              <AlertDescription className=\"text-blue-200 text-sm\">\r\n                Вывод доступен при достижении минимальной суммы.<br />\r\n                Все выплаты обрабатываются вручную и фиксируются.\r\n              </AlertDescription>\r\n            </Alert>\r\n            \r\n            <p className=\"text-gray-400 mb-4\">Выберите криптовалюту для вывода:</p>\r\n            \r\n            {config?.btc?.enabled && (\r\n              <Card \r\n                className=\"cursor-pointer hover-elevate bg-gray-800/50 border-gray-700\"\r\n                onClick={() => setSelectedCrypto('btc')}\r\n                data-testid=\"card-select-btc\"\r\n              >\r\n                <CardContent className=\"flex items-center gap-4 p-4\">\r\n                  <div className=\"w-12 h-12 rounded-full bg-orange-500/20 flex items-center justify-center\">\r\n                    <Bitcoin className=\"w-6 h-6 text-orange-500\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-semibold\">Bitcoin (BTC)</div>\r\n                    <div className=\"text-sm text-gray-400\">\r\n                      Баланс: {user?.btcBalance.toFixed(8)} BTC\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {config?.eth?.enabled && (\r\n              <Card \r\n                className=\"cursor-pointer hover-elevate bg-gray-800/50 border-gray-700\"\r\n                onClick={() => setSelectedCrypto('eth')}\r\n                data-testid=\"card-select-eth\"\r\n              >\r\n                <CardContent className=\"flex items-center gap-4 p-4\">\r\n                  <div className=\"w-12 h-12 rounded-full bg-purple-500/20 flex items-center justify-center\">\r\n                    <SiEthereum className=\"w-6 h-6 text-purple-400\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-semibold\">Ethereum (ETH)</div>\r\n                    <div className=\"text-sm text-gray-400\">\r\n                      Баланс: {user?.ethBalance.toFixed(8)} ETH\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {(config?.usdt?.bep20?.enabled || config?.usdt?.trc20?.enabled || \r\n              config?.usdt?.erc20?.enabled || config?.usdt?.ton?.enabled) && (\r\n              <Card \r\n                className=\"cursor-pointer hover-elevate bg-gray-800/50 border-gray-700\"\r\n                onClick={() => setSelectedCrypto('usdt')}\r\n                data-testid=\"card-select-usdt\"\r\n              >\r\n                <CardContent className=\"flex items-center gap-4 p-4\">\r\n                  <div className=\"w-12 h-12 rounded-full bg-green-500/20 flex items-center justify-center\">\r\n                    <SiTether className=\"w-6 h-6 text-green-500\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-semibold\">Tether (USDT)</div>\r\n                    <div className=\"text-sm text-gray-400\">\r\n                      Баланс: {user?.usdtBalance.toFixed(2)} USDT\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n            \r\n            {!config?.btc?.enabled && !config?.eth?.enabled && \r\n             !config?.usdt?.bep20?.enabled && !config?.usdt?.trc20?.enabled && \r\n             !config?.usdt?.erc20?.enabled && !config?.usdt?.ton?.enabled && (\r\n              <Alert className=\"bg-yellow-500/10 border-yellow-500/30\">\r\n                <AlertCircle className=\"w-4 h-4 text-yellow-400\" />\r\n                <AlertDescription className=\"text-yellow-200 text-sm\">\r\n                  Вывод временно недоступен. Попробуйте позже.\r\n                </AlertDescription>\r\n              </Alert>\r\n            )}\r\n\r\n            {myWithdrawals.length > 0 && (\r\n              <div className=\"mt-8\">\r\n                <h2 className=\"text-lg font-semibold mb-4\">История заявок</h2>\r\n                <div className=\"space-y-3\">\r\n                  {myWithdrawals.map((w) => {\r\n                    const statusInfo = STATUS_LABELS[w.status] || STATUS_LABELS.pending;\r\n                    const StatusIcon = statusInfo.icon;\r\n                    return (\r\n                      <Card key={w.id} className=\"bg-gray-800/30 border-gray-700\" data-testid={`card-withdrawal-${w.id}`}>\r\n                        <CardContent className=\"p-3\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                              <div className=\"font-medium\">\r\n                                {parseFloat(w.amount).toFixed(w.cryptoType === 'usdt' ? 2 : 8)} {w.cryptoType.toUpperCase()}\r\n                              </div>\r\n                              <div className=\"text-xs text-gray-400\">\r\n                                {w.network && NETWORK_LABELS[w.network as UsdtNetwork]?.name}\r\n                              </div>\r\n                            </div>\r\n                            <Badge className={statusInfo.color}>\r\n                              <StatusIcon className=\"w-3 h-3 mr-1\" />\r\n                              {statusInfo.label}\r\n                            </Badge>\r\n                          </div>\r\n                          {w.txHash && (\r\n                            <div className=\"text-xs text-gray-500 mt-2 truncate\">\r\n                              TX: {w.txHash}\r\n                            </div>\r\n                          )}\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : selectedCrypto === 'usdt' && !selectedNetwork ? (\r\n          <div className=\"space-y-4\">\r\n            <Button variant=\"ghost\" onClick={resetForm} className=\"mb-4\" data-testid=\"button-back-crypto\">\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" /> Назад\r\n            </Button>\r\n            \r\n            <div className=\"flex items-center gap-3 mb-6\">\r\n              <div className=\"w-12 h-12 rounded-full bg-green-500/20 flex items-center justify-center\">\r\n                <SiTether className=\"w-6 h-6 text-green-500\" />\r\n              </div>\r\n              <div>\r\n                <div className=\"font-semibold text-lg\">USDT</div>\r\n                <div className=\"text-sm text-gray-400\">Выберите сеть</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n              {(['bep20', 'trc20', 'ton', 'erc20'] as UsdtNetwork[]).map((network) => {\r\n                const networkInfo = NETWORK_LABELS[network];\r\n                const enabled = isNetworkEnabled(network);\r\n                const fee = config?.usdt[network]?.networkFee || 0;\r\n                const min = config?.usdt[network]?.minAmount || 0;\r\n                \r\n                return (\r\n                  <Card \r\n                    key={network}\r\n                    className={`${enabled ? 'cursor-pointer hover-elevate' : 'opacity-50'} bg-gray-800/50 border-gray-700`}\r\n                    onClick={() => enabled && setSelectedNetwork(network)}\r\n                    data-testid={`card-network-${network}`}\r\n                  >\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                          <div className=\"font-semibold text-green-400\">{networkInfo.name}</div>\r\n                          <div className=\"text-sm text-gray-400\">{networkInfo.fullName}</div>\r\n                        </div>\r\n                        {!enabled && <Badge variant=\"secondary\">Недоступно</Badge>}\r\n                      </div>\r\n                      <div className=\"mt-2 text-sm\">\r\n                        <div className=\"flex justify-between text-gray-400\">\r\n                          <span>Минимум:</span>\r\n                          <span>{min} USDT</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between text-gray-400\">\r\n                          <span>Комиссия сети:</span>\r\n                          <span>~{fee} USDT</span>\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            <Button variant=\"ghost\" onClick={() => selectedCrypto === 'usdt' ? setSelectedNetwork(null) : resetForm()} className=\"mb-4\" data-testid=\"button-back-form\">\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" /> Назад\r\n            </Button>\r\n\r\n            <Card className=\"bg-gray-800/50 border-gray-700\">\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  {selectedCrypto === 'btc' && <Bitcoin className=\"w-6 h-6 text-orange-500\" />}\r\n                  {selectedCrypto === 'eth' && <SiEthereum className=\"w-6 h-6 text-purple-400\" />}\r\n                  {selectedCrypto === 'usdt' && <SiTether className=\"w-6 h-6 text-green-500\" />}\r\n                  {selectedCrypto.toUpperCase()}\r\n                  {selectedNetwork && (\r\n                    <Badge className=\"bg-green-500/20 text-green-400 ml-2\">\r\n                      {NETWORK_LABELS[selectedNetwork].name}\r\n                    </Badge>\r\n                  )}\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  Баланс: {formatCrypto(getBalance(), selectedCrypto)} {selectedCrypto.toUpperCase()}\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30\">\r\n                  <div className=\"flex items-start gap-2\">\r\n                    <AlertCircle className=\"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5\" />\r\n                    <div className=\"text-sm\">\r\n                      <div className=\"text-blue-400 font-medium\">Информация о выводе</div>\r\n                      <div className=\"text-gray-300 mt-1\">\r\n                        Минимальный вывод: <span className=\"font-medium\">{getMinAmount()} {selectedCrypto.toUpperCase()}</span>\r\n                      </div>\r\n                      <div className=\"text-gray-300\">\r\n                        Комиссия сети: <span className=\"font-medium\">~{getNetworkFee()} {selectedCrypto.toUpperCase()}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <Label htmlFor=\"amount\">Сумма вывода</Label>\r\n                  <div className=\"relative mt-1\">\r\n                    <Input\r\n                      id=\"amount\"\r\n                      type=\"number\"\r\n                      step=\"any\"\r\n                      placeholder={`Мин. ${getMinAmount()}`}\r\n                      value={amount}\r\n                      onChange={(e) => setAmount(e.target.value)}\r\n                      className=\"pr-20\"\r\n                      data-testid=\"input-amount\"\r\n                    />\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 text-xs\"\r\n                      onClick={() => setAmount(String(getBalance()))}\r\n                      data-testid=\"button-max\"\r\n                    >\r\n                      MAX\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <Label htmlFor=\"wallet\">Адрес кошелька</Label>\r\n                  <Input\r\n                    id=\"wallet\"\r\n                    placeholder=\"Введите адрес кошелька\"\r\n                    value={walletAddress}\r\n                    onChange={(e) => setWalletAddress(e.target.value)}\r\n                    className=\"mt-1\"\r\n                    data-testid=\"input-wallet\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/30\">\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <Checkbox\r\n                      id=\"confirm\"\r\n                      checked={networkConfirmed}\r\n                      onCheckedChange={(checked) => setNetworkConfirmed(checked === true)}\r\n                      data-testid=\"checkbox-confirm\"\r\n                    />\r\n                    <Label htmlFor=\"confirm\" className=\"text-sm cursor-pointer\">\r\n                      Я понимаю, что выбрал сеть{' '}\r\n                      <span className=\"font-bold text-yellow-400\">\r\n                        {selectedCrypto === 'usdt' && selectedNetwork \r\n                          ? NETWORK_LABELS[selectedNetwork].name \r\n                          : selectedCrypto === 'btc' ? 'Bitcoin' : 'Ethereum'\r\n                        }\r\n                      </span>{' '}\r\n                      и ввёл правильный адрес. Отправка на неверный адрес или в неверную сеть приведёт к потере средств.\r\n                    </Label>\r\n                  </div>\r\n                </div>\r\n\r\n                <Button\r\n                  className=\"w-full\"\r\n                  disabled={!canSubmit() || withdrawMutation.isPending}\r\n                  onClick={() => withdrawMutation.mutate()}\r\n                  data-testid=\"button-submit\"\r\n                >\r\n                  {withdrawMutation.isPending ? (\r\n                    <>\r\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                      Отправка...\r\n                    </>\r\n                  ) : (\r\n                    'Отправить заявку на вывод'\r\n                  )}\r\n                </Button>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2784, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/DatabaseHealth.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { CheckCircle, XCircle, Loader2, Database, Network, Server } from 'lucide-react';\n\nexport default function DatabaseHealth() {\n  const [status, setStatus] = useState({\n    isConnected: false,\n    isDatabaseAccessible: false,\n    isTablesAccessible: false,\n    lastCheck: null as string | null,\n    error: null as string | null,\n    details: null as string | null,\n    errorCode: null as string | null,\n    errorDetail: null as string | null,\n    errorHint: null as string | null,\n  });\n\n  const [envInfo, setEnvInfo] = useState({\n    databaseHost: 'Not Available (Server-side only)',\n    databasePort: 'Not Available (Server-side only)',\n    sessionSecretStatus: 'Not Available (Server-side only)',\n    nodeEnv: typeof window !== 'undefined' ? process.env.NODE_ENV || 'development' : 'Not Available'\n  });\n\n  const [loading, setLoading] = useState(false);\n  const [refreshLoading, setRefreshLoading] = useState(false);\n\n  const fetchEnvInfo = async () => {\n    try {\n      const response = await fetch('/api/env-info', { credentials: 'include' });\n      if (response.ok) {\n        const data = await response.json();\n        console.log('Environment info received:', data);\n        setEnvInfo({\n          databaseHost: data.databaseHost || 'Not Available',\n          databasePort: data.databasePort || 'Not Available',\n          sessionSecretStatus: data.sessionSecretStatus || 'Not Available',\n          nodeEnv: data.nodeEnv || 'Not Available'\n        });\n      } else {\n        console.error('Failed to fetch environment info:', response.status, response.statusText);\n        const errorText = await response.text();\n        console.error('Error response:', errorText);\n\n        // В случае ошибки, используем реальные значения из ответа, если они есть\n        try {\n          const errorData = JSON.parse(errorText);\n          setEnvInfo({\n            databaseHost: errorData.databaseHost || 'Not Available',\n            databasePort: errorData.databasePort || 'Not Available',\n            sessionSecretStatus: errorData.sessionSecretStatus || 'Not Available',\n            nodeEnv: errorData.nodeEnv || (typeof window !== 'undefined' ? process.env.NODE_ENV || 'production' : 'production')\n          });\n        } catch {\n          // Если не можем распарсить ошибку, используем значения по умолчанию\n          setEnvInfo({\n            databaseHost: 'Not Available (Check Vercel Logs)',\n            databasePort: 'Not Available (Check Vercel Logs)',\n            sessionSecretStatus: 'Not Available (Check Vercel Logs)',\n            nodeEnv: typeof window !== 'undefined' ? process.env.NODE_ENV || 'production' : 'production'\n          });\n        }\n      }\n    } catch (error) {\n      console.error('Error fetching environment info:', error);\n      // В случае сетевой ошибки, используем реальные данные, если возможно\n      setEnvInfo({\n        databaseHost: 'supabase.db', // Используем значение по умолчанию\n        databasePort: '6543', // Используем значение по умолчанию\n        sessionSecretStatus: process.env.SESSION_SECRET ? 'Set' : 'Not Set', // Проверяем переменную на клиенте\n        nodeEnv: typeof window !== 'undefined' ? process.env.NODE_ENV || 'production' : 'production'\n      });\n    }\n  };\n\n  const refreshHealthCheck = async () => {\n    setRefreshLoading(true);\n    try {\n      const response = await fetch('/api/health-check');\n      const data = await response.json();\n\n      if (response.ok) {\n        setStatus({\n          isConnected: true,\n          isDatabaseAccessible: data.databaseConnected,\n          isTablesAccessible: data.tablesAccessible,\n          lastCheck: new Date().toLocaleString('ru-RU'),\n          error: null,\n          details: null,\n          errorCode: null,\n          errorDetail: null,\n          errorHint: null,\n        });\n      } else {\n        setStatus({\n          isConnected: false,\n          isDatabaseAccessible: false,\n          isTablesAccessible: false,\n          lastCheck: new Date().toLocaleString('ru-RU'),\n          error: data.error || 'Неизвестная ошибка',\n          details: data.stack || null,\n          errorCode: data.code || null,\n          errorDetail: data.detail || null,\n          errorHint: data.hint || null,\n        });\n      }\n    } catch (error) {\n      setStatus({\n        isConnected: false,\n        isDatabaseAccessible: false,\n        isTablesAccessible: false,\n        lastCheck: new Date().toLocaleString('ru-RU'),\n        error: error instanceof Error ? error.message : 'Ошибка при проверке подключения',\n        details: error instanceof Error ? error.stack || null : null,\n        errorCode: null,\n        errorDetail: null,\n        errorHint: null,\n      });\n    } finally {\n      setRefreshLoading(false);\n    }\n  };\n\n  // Загружаем информацию об окружении при монтировании компонента\n  useEffect(() => {\n    fetchEnvInfo();\n  }, []);\n\n  const checkConnection = async () => {\n    setLoading(true);\n    setStatus({\n      isConnected: false,\n      isDatabaseAccessible: false,\n      isTablesAccessible: false,\n      lastCheck: null,\n      error: null,\n      details: null,\n      errorCode: null,\n      errorDetail: null,\n      errorHint: null,\n    });\n\n    try {\n      const response = await fetch('/api/health-check');\n      const data = await response.json();\n\n      if (response.ok) {\n        setStatus({\n          isConnected: true,\n          isDatabaseAccessible: data.databaseConnected,\n          isTablesAccessible: data.tablesAccessible,\n          lastCheck: new Date().toLocaleString('ru-RU'),\n          error: null,\n          details: null,\n          errorCode: null,\n          errorDetail: null,\n          errorHint: null,\n        });\n      } else {\n        setStatus({\n          isConnected: false,\n          isDatabaseAccessible: false,\n          isTablesAccessible: false,\n          lastCheck: new Date().toLocaleString('ru-RU'),\n          error: data.error || 'Неизвестная ошибка',\n          details: data.stack || null,\n          errorCode: data.code || null,\n          errorDetail: data.detail || null,\n          errorHint: data.hint || null,\n        });\n      }\n    } catch (error) {\n      setStatus({\n        isConnected: false,\n        isDatabaseAccessible: false,\n        isTablesAccessible: false,\n        lastCheck: new Date().toLocaleString('ru-RU'),\n        error: error instanceof Error ? error.message : 'Ошибка при проверке подключения',\n        details: error instanceof Error ? error.stack || null : null,\n        errorCode: null,\n        errorDetail: null,\n        errorHint: null,\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStatusIcon = (status: boolean) => {\n    if (status === null) return null;\n    return status ? (\n      <CheckCircle className=\"w-5 h-5 text-green-500\" />\n    ) : (\n      <XCircle className=\"w-5 h-5 text-red-500\" />\n    );\n  };\n\n  const getStatusBadge = (status: boolean) => {\n    if (status === null) return <Badge variant=\"secondary\">Не проверено</Badge>;\n    return status ? (\n      <Badge variant=\"default\" className=\"bg-green-600\">ОК</Badge>\n    ) : (\n      <Badge variant=\"destructive\">Ошибка</Badge>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background p-4\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"mb-8 text-center\">\n          <h1 className=\"text-3xl font-bold mb-2\">Проверка подключения к базе данных</h1>\n          <p className=\"text-muted-foreground\">\n            Страница для диагностики подключения к базе данных игры\n          </p>\n        </div>\n\n        <Card className=\"mb-6\">\n          <CardHeader className=\"flex flex-row items-center justify-between\">\n            <CardTitle>Состояние подключения</CardTitle>\n            <Button \n              onClick={checkConnection} \n              disabled={loading}\n              className=\"flex items-center gap-2\"\n            >\n              {loading ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Network className=\"w-4 h-4\" />\n              )}\n              {loading ? 'Проверка...' : 'Проверить подключение'}\n            </Button>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div className=\"flex items-center gap-3 p-3 border rounded-lg\">\n                <Server className=\"w-6 h-6 text-blue-500\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Сервер</p>\n                  <div className=\"flex items-center gap-2\">\n                    {getStatusIcon(status.isConnected)}\n                    <span>{status.isConnected ? 'Доступен' : 'Недоступен'}</span>\n                    {getStatusBadge(status.isConnected)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3 p-3 border rounded-lg\">\n                <Database className=\"w-6 h-6 text-blue-500\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">База данных</p>\n                  <div className=\"flex items-center gap-2\">\n                    {getStatusIcon(status.isDatabaseAccessible)}\n                    <span>{status.isDatabaseAccessible ? 'Подключена' : 'Не подключена'}</span>\n                    {getStatusBadge(status.isDatabaseAccessible)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3 p-3 border rounded-lg\">\n                <CheckCircle className=\"w-6 h-6 text-blue-500\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Таблицы</p>\n                  <div className=\"flex items-center gap-2\">\n                    {getStatusIcon(status.isTablesAccessible)}\n                    <span>{status.isTablesAccessible ? 'Доступны' : 'Недоступны'}</span>\n                    {getStatusBadge(status.isTablesAccessible)}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {status.lastCheck && (\n              <div className=\"mt-4 text-sm text-muted-foreground\">\n                Последняя проверка: {status.lastCheck}\n              </div>\n            )}\n\n            {status.error && (\n              <div className=\"mt-4 p-3 bg-destructive/10 border border-destructive rounded-lg\">\n                <p className=\"text-sm font-medium text-destructive\">Ошибка:</p>\n                <p className=\"text-sm\">{status.error}</p>\n                {status.details && (\n                  <details className=\"mt-2 text-xs text-destructive\">\n                    <summary>Подробнее</summary>\n                    <pre className=\"whitespace-pre-wrap\">{status.details}</pre>\n                  </details>\n                )}\n                {(status.errorCode || status.errorDetail || status.errorHint) && (\n                  <details className=\"mt-2 text-xs text-destructive\">\n                    <summary>Дополнительная информация об ошибке</summary>\n                    {status.errorCode && <div><strong>Код ошибки:</strong> {status.errorCode}</div>}\n                    {status.errorDetail && <div><strong>Детали:</strong> {status.errorDetail}</div>}\n                    {status.errorHint && <div><strong>Подсказка:</strong> {status.errorHint}</div>}\n                  </details>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between\">\n            <CardTitle>Информация о подключении</CardTitle>\n            <Button\n              onClick={refreshHealthCheck}\n              disabled={refreshLoading}\n              className=\"flex items-center gap-2\"\n            >\n              {refreshLoading ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Network className=\"w-4 h-4\" />\n              )}\n              {refreshLoading ? 'Обновление...' : 'Обновить'}\n            </Button>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-muted-foreground\">Тип базы данных:</span>\n                <span>PostgreSQL (Supabase)</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-muted-foreground\">Хост базы данных:</span>\n                <span>{envInfo.databaseHost || 'Загрузка...'}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-muted-foreground\">Порт базы данных:</span>\n                <span>{envInfo.databasePort || 'Загрузка...'}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-muted-foreground\">Статус SESSION_SECRET:</span>\n                <span>{envInfo.sessionSecretStatus || 'Загрузка...'}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-muted-foreground\">Среда выполнения (NODE_ENV):</span>\n                <span>{envInfo.nodeEnv || 'Загрузка...'}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-muted-foreground\">Серверная часть:</span>\n                <span>Vercel Serverless</span>\n              </div>\n            </div>\n\n            <div className=\"mt-6 p-4 bg-muted rounded-lg\">\n              <h4 className=\"font-medium mb-2\">Инструкция по устранению неполадок:</h4>\n              <ul className=\"text-sm space-y-1 list-disc pl-5\">\n                <li>Если база данных не подключена, проверьте переменную DATABASE_URL в настройках Vercel</li>\n                <li>Убедитесь, что Supabase проект активен и доступен</li>\n                <li>Проверьте, что SSL настройки корректны (rejectUnauthorized: false)</li>\n                <li>Убедитесь, что таблицы были созданы с помощью миграций</li>\n              </ul>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3685, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/not-found.tsx"],"sourcesContent":["import { Card, CardContent } from \"@/components/ui/card\";\r\nimport { AlertCircle } from \"lucide-react\";\r\n\r\nexport default function NotFound() {\r\n  return (\r\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\r\n      <Card className=\"w-full max-w-md mx-4\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex mb-4 gap-2\">\r\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\r\n          </div>\r\n\r\n          <p className=\"mt-4 text-sm text-gray-600\">\r\n            Did you forget to add the page to the router?\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;;;;AAEe,SAAS;IACtB,qBACE,qKAAC;QAAI,WAAU;kBACb,cAAA,qKAAC,0HAAI;YAAC,WAAU;sBACd,cAAA,qKAAC,iIAAW;gBAAC,WAAU;;kCACrB,qKAAC;wBAAI,WAAU;;0CACb,qKAAC,4NAAW;gCAAC,WAAU;;;;;;0CACvB,qKAAC;gCAAG,WAAU;0CAAmC;;;;;;;;;;;;kCAGnD,qKAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;;;;;;;;;;;AAOpD"}},
    {"offset": {"line": 3763, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/App.tsx"],"sourcesContent":["import { Switch, Route } from \"wouter\";\nimport { useMemo } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { queryClient } from \"../lib/queryClient\";\nimport { QueryClientProvider, useQuery } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { UserProvider, useUser } from \"@/contexts/UserContext\";\nimport Home from \"./index\";\nimport Admin from \"./Admin\";\nimport LeagueLeaderboard from \"./LeagueLeaderboard\";\nimport Withdraw from \"./Withdraw\";\nimport DatabaseHealth from \"./DatabaseHealth\";\nimport NotFound from \"./not-found\";\nimport MaintenancePage from \"@/components/MaintenancePage\";\nimport { Loader2 } from \"lucide-react\";\n\ninterface MaintenanceConfig {\n  enabled: boolean;\n  endTime: string | null;\n  message: string | null;\n}\n\nfunction Router() {\n  const router = useRouter();\n\n  // Определяем, какой компонент отображать в зависимости от маршрута\n  if (router.pathname === '/') {\n    return <Home />;\n  } else if (router.pathname === '/admin' || router.pathname.startsWith('/admin')) {\n    return <Admin />;\n  } else if (router.pathname.startsWith('/league/')) {\n    return <LeagueLeaderboard />;\n  } else if (router.pathname === '/withdraw') {\n    return <Withdraw />;\n  } else if (router.pathname === '/db-health') {\n    return <DatabaseHealth />;\n  } else {\n    return <NotFound />;\n  }\n}\n\nfunction LoadingScreen() {\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center\">\n      <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n    </div>\n  );\n}\n\nfunction TelegramRequiredScreen() {\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col items-center justify-center p-6 text-center\">\n      <div className=\"text-6xl mb-4\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\" className=\"w-16 h-16 mx-auto\">\n          <linearGradient id=\"tgGrad\" x1=\"9.858\" y1=\"9.858\" x2=\"38.142\" y2=\"38.142\" gradientUnits=\"userSpaceOnUse\">\n            <stop offset=\"0\" stopColor=\"#33bef0\"/>\n            <stop offset=\"1\" stopColor=\"#0a85d9\"/>\n          </linearGradient>\n          <path fill=\"url(#tgGrad)\" d=\"M24 4A20 20 0 1 0 24 44A20 20 0 1 0 24 4Z\"/>\n          <path fill=\"#fff\" d=\"M33.95,15l-3.746,19.126c0,0-0.161,0.874-1.245,0.874c-0.576,0-0.873-0.274-0.873-0.274l-8.114-6.733 l-3.97-2.001l-5.095-1.355c0,0-0.907-0.262-0.907-1.012c0-0.625,0.933-0.923,0.933-0.923l21.316-8.468 c-0.001-0.001,0.651-0.235,1.126-0.234C33.667,14,34,14.125,34,14.5C34,14.75,33.95,15,33.95,15z\"/>\n          <path fill=\"#b0bec5\" d=\"M23,30.505l-3.426,3.374c0,0-0.149,0.115-0.348,0.12c-0.069,0.002-0.143-0.009-0.219-0.043 l0.964-5.965L23,30.505z\"/>\n          <path fill=\"#cfd8dc\" d=\"M29.897,18.196c-0.169-0.22-0.481-0.26-0.701-0.093L16,26c0,0,2.106,5.892,2.427,6.912 c0.322,1.021,0.58,1.045,0.58,1.045l0.964-5.965l9.832-9.096C30.022,18.679,30.066,18.417,29.897,18.196z\"/>\n        </svg>\n      </div>\n      <h1 className=\"text-2xl font-bold mb-2 text-foreground\">Beads Line</h1>\n      <p className=\"text-muted-foreground mb-6\">\n        Игра доступна только в Telegram\n      </p>\n      <a \n        href=\"https://t.me/Beads_Line_Bot\" \n        className=\"inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg font-medium hover-elevate\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        data-testid=\"link-open-telegram\"\n      >\n        Открыть в Telegram\n      </a>\n    </div>\n  );\n}\n\nfunction MaintenanceWrapper() {\n  const { user, isLoading: userLoading, error } = useUser();\n  const router = useRouter();\n  const location = router.asPath;\n\n  const {\n    data: maintenance,\n    isLoading: maintenanceLoading,\n  } = useQuery<MaintenanceConfig>({\n    queryKey: [\"/api/maintenance\"],\n    refetchInterval: 15000,\n    staleTime: 0,\n  });\n\n  // 1. ОПРЕДЕЛЯЕМ АДМИНКУ\n  const isAdminPage = router.pathname.startsWith('/admin');\n\n  // 2. ЕСЛИ ЭТО АДМИНКА - ПРОПУСКАЕМ ДАЛЬШЕ ДЛЯ ПРОВЕРКИ В КОМПОНЕНТЕ\n  if (isAdminPage) {\n    // Пропускаем проверку Telegram для админки, но проверяем права в компоненте Admin\n    if (userLoading) {\n      return <LoadingScreen />;\n    }\n    // Показываем компонент Admin, где будет проверка прав и форма входа\n    return <Router />;\n  }\n\n  // 3. СТАНДАРТНЫЕ ПРОВЕРКИ ДЛЯ ИГРОКОВ\n  if (maintenanceLoading || userLoading) {\n    return <LoadingScreen />;\n  }\n\n  // Показываем экран Telegram только для определенных случаев, не для всех пользователей\n  // Убираем проверку telegram_required, чтобы игра была доступна всем\n\n  if (maintenance?.enabled && !user?.isAdmin) {\n    return (\n      <MaintenancePage\n        endTime={maintenance.endTime}\n        message={maintenance.message}\n      />\n    );\n  }\n\n  return <Router />;\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <UserProvider>\n          <Toaster />\n          <MaintenanceWrapper />\n        </UserProvider>\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA,SAAS;IACP,MAAM,SAAS,IAAA,oIAAS;IAExB,mEAAmE;IACnE,IAAI,OAAO,QAAQ,KAAK,KAAK;QAC3B,qBAAO,qKAAC,mHAAI;;;;;IACd,OAAO,IAAI,OAAO,QAAQ,KAAK,YAAY,OAAO,QAAQ,CAAC,UAAU,CAAC,WAAW;QAC/E,qBAAO,qKAAC,mHAAK;;;;;IACf,OAAO,IAAI,OAAO,QAAQ,CAAC,UAAU,CAAC,aAAa;QACjD,qBAAO,qKAAC,+HAAiB;;;;;IAC3B,OAAO,IAAI,OAAO,QAAQ,KAAK,aAAa;QAC1C,qBAAO,qKAAC,sHAAQ;;;;;IAClB,OAAO,IAAI,OAAO,QAAQ,KAAK,cAAc;QAC3C,qBAAO,qKAAC,4HAAc;;;;;IACxB,OAAO;QACL,qBAAO,qKAAC,0HAAQ;;;;;IAClB;AACF;AAEA,SAAS;IACP,qBACE,qKAAC;QAAI,WAAU;kBACb,cAAA,qKAAC,qNAAO;YAAC,WAAU;;;;;;;;;;;AAGzB;AAEA,SAAS;IACP,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAI,WAAU;0BACb,cAAA,qKAAC;oBAAI,OAAM;oBAA6B,SAAQ;oBAAY,WAAU;;sCACpE,qKAAC;4BAAe,IAAG;4BAAS,IAAG;4BAAQ,IAAG;4BAAQ,IAAG;4BAAS,IAAG;4BAAS,eAAc;;8CACtF,qKAAC;oCAAK,QAAO;oCAAI,WAAU;;;;;;8CAC3B,qKAAC;oCAAK,QAAO;oCAAI,WAAU;;;;;;;;;;;;sCAE7B,qKAAC;4BAAK,MAAK;4BAAe,GAAE;;;;;;sCAC5B,qKAAC;4BAAK,MAAK;4BAAO,GAAE;;;;;;sCACpB,qKAAC;4BAAK,MAAK;4BAAU,GAAE;;;;;;sCACvB,qKAAC;4BAAK,MAAK;4BAAU,GAAE;;;;;;;;;;;;;;;;;0BAG3B,qKAAC;gBAAG,WAAU;0BAA0C;;;;;;0BACxD,qKAAC;gBAAE,WAAU;0BAA6B;;;;;;0BAG1C,qKAAC;gBACC,MAAK;gBACL,WAAU;gBACV,QAAO;gBACP,KAAI;gBACJ,eAAY;0BACb;;;;;;;;;;;;AAKP;AAEA,SAAS;IACP,MAAM,EAAE,IAAI,EAAE,WAAW,WAAW,EAAE,KAAK,EAAE,GAAG,IAAA,4HAAO;IACvD,MAAM,SAAS,IAAA,oIAAS;IACxB,MAAM,WAAW,OAAO,MAAM;IAE9B,MAAM,EACJ,MAAM,WAAW,EACjB,WAAW,kBAAkB,EAC9B,GAAG,IAAA,uOAAQ,EAAoB;QAC9B,UAAU;YAAC;SAAmB;QAC9B,iBAAiB;QACjB,WAAW;IACb;IAEA,wBAAwB;IACxB,MAAM,cAAc,OAAO,QAAQ,CAAC,UAAU,CAAC;IAE/C,oEAAoE;IACpE,IAAI,aAAa;QACf,kFAAkF;QAClF,IAAI,aAAa;YACf,qBAAO,qKAAC;;;;;QACV;QACA,oEAAoE;QACpE,qBAAO,qKAAC;;;;;IACV;IAEA,sCAAsC;IACtC,IAAI,sBAAsB,aAAa;QACrC,qBAAO,qKAAC;;;;;IACV;IAEA,uFAAuF;IACvF,oEAAoE;IAEpE,IAAI,aAAa,WAAW,CAAC,MAAM,SAAS;QAC1C,qBACE,qKAAC,kIAAe;YACd,SAAS,YAAY,OAAO;YAC5B,SAAS,YAAY,OAAO;;;;;;IAGlC;IAEA,qBAAO,qKAAC;;;;;AACV;AAEA,SAAS;IACP,qBACE,qKAAC,kPAAmB;QAAC,QAAQ,0HAAW;kBACtC,cAAA,qKAAC,wIAAe;sBACd,cAAA,qKAAC,iIAAY;;kCACX,qKAAC,gIAAO;;;;;kCACR,qKAAC;;;;;;;;;;;;;;;;;;;;;AAKX;uCAEe"}},
    {"offset": {"line": 4085, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/_app.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport App from './App';\n\n// Обертка для SSR\nexport default function WrappedApp(props: any) {\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  if (!isMounted) {\n    // Возвращаем пустой div на сервере\n    return <div />;\n  }\n\n  // Отображаем оригинальное приложение на клиенте\n  return <App {...props} />;\n}"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;;;;AAGe,SAAS,WAAW,KAAU;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+GAAQ,EAAC;IAE3C,IAAA,gHAAS,EAAC;QACR,aAAa;IACf,GAAG,EAAE;IAEL,IAAI,CAAC,WAAW;QACd,mCAAmC;QACnC,qBAAO,qKAAC;;;;;IACV;IAEA,gDAAgD;IAChD,qBAAO,qKAAC,iHAAG;QAAE,GAAG,KAAK;;;;;;AACvB"}}]
}