{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///D:/BeadsLine/pages/api/env-info.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next';\n\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  if (req.method !== 'GET') {\n    return res.status(405).json({ error: 'Method not allowed' });\n  }\n\n  try {\n    console.log('Environment info endpoint called');\n    console.log('DATABASE_URL exists:', !!process.env.DATABASE_URL);\n    console.log('SESSION_SECRET exists:', !!process.env.SESSION_SECRET);\n    console.log('NODE_ENV:', process.env.NODE_ENV);\n\n    // Извлекаем хост из DATABASE_URL, если возможно\n    let databaseHost = 'Not Set';\n    let databasePort = 'Not Set';\n\n    if (process.env.DATABASE_URL) {\n      try {\n        // Парсим URL для получения хоста и порта\n        const url = new URL(process.env.DATABASE_URL);\n        databaseHost = url.hostname;\n        databasePort = url.port || '5432'; // по умолчанию PostgreSQL использует 5432\n      } catch (urlError) {\n        console.error('Error parsing DATABASE_URL:', urlError);\n        // Если не можем распарсить, используем общее описание\n        databaseHost = 'supabase.db';\n        databasePort = '6543'; // предполагаем pgbouncer\n      }\n    }\n\n    // Возвращаем конкретные значения для каждого поля\n    res.status(200).json({\n      databaseHost,\n      databasePort,\n      sessionSecretStatus: process.env.SESSION_SECRET ? 'Set' : 'Not Set',\n      nodeEnv: process.env.NODE_ENV || 'development',\n      timestamp: new Date().toISOString(),\n    });\n  } catch (error) {\n    console.error('Error in env-info endpoint:', error);\n    // В случае ошибки, возвращаем минимально возможный ответ\n    res.status(500).json({\n      databaseHost: 'Error',\n      databasePort: 'Error',\n      sessionSecretStatus: 'Error',\n      nodeEnv: 'Error',\n      timestamp: new Date().toISOString(),\n    });\n  }\n}"],"names":[],"mappings":";;;;AAEe,SAAS,QAAQ,GAAmB,EAAE,GAAoB;IACvE,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IAC5D;IAEA,IAAI;QACF,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,wBAAwB,CAAC,CAAC,QAAQ,GAAG,CAAC,YAAY;QAC9D,QAAQ,GAAG,CAAC,0BAA0B,CAAC,CAAC,QAAQ,GAAG,CAAC,cAAc;QAClE,QAAQ,GAAG,CAAC;QAEZ,gDAAgD;QAChD,IAAI,eAAe;QACnB,IAAI,eAAe;QAEnB,IAAI,QAAQ,GAAG,CAAC,YAAY,EAAE;YAC5B,IAAI;gBACF,yCAAyC;gBACzC,MAAM,MAAM,IAAI,IAAI,QAAQ,GAAG,CAAC,YAAY;gBAC5C,eAAe,IAAI,QAAQ;gBAC3B,eAAe,IAAI,IAAI,IAAI,QAAQ,0CAA0C;YAC/E,EAAE,OAAO,UAAU;gBACjB,QAAQ,KAAK,CAAC,+BAA+B;gBAC7C,sDAAsD;gBACtD,eAAe;gBACf,eAAe,QAAQ,yBAAyB;YAClD;QACF;QAEA,kDAAkD;QAClD,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YACnB;YACA;YACA,qBAAqB,QAAQ,GAAG,CAAC,cAAc,GAAG,QAAQ;YAC1D,SAAS,mDAAwB;YACjC,WAAW,IAAI,OAAO,WAAW;QACnC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,yDAAyD;QACzD,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YACnB,cAAc;YACd,cAAc;YACd,qBAAqB;YACrB,SAAS;YACT,WAAW,IAAI,OAAO,WAAW;QACnC;IACF;AACF"}}]
}